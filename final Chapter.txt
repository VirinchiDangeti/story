This is the final flow for understanding